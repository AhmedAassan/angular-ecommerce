<div class="forgot-password-wrapper">
    <!-- Main container -->
    <div class="container">
        <h2 class="page-title">Forgot Password</h2>

        <!-- Status messages -->
        <div *ngIf="msg()" class="alert alert-success">{{ msg() }}</div>
        <div *ngIf="err()" class="alert alert-danger">{{ err() }}</div>

        <!-- Interactive area only -->
        <div [class.disabled-content]="busy()">
            <!-- Step 1: Mobile -->
            <div class="step-card" *ngIf="step() === 1">
                <div class="step-header">
                    <h5 class="step-title">Verify your mobile</h5>
                </div>
                <div class="step-body">
                    <form [formGroup]="mobileForm" (ngSubmit)="requestOtp()">
                        <div class="form-group">
                            <label class="form-label">Mobile number</label>
                            <input class="form-control" formControlName="mobileNo" placeholder="e.g. 9655xxxxxxx" />
                        </div>
                        <button class="btn btn-primary" type="submit" [disabled]="busy()">Send OTP</button>
                    </form>
                </div>
            </div>

            <!-- Step 2: OTP -->
            <div class="step-card" *ngIf="step() === 2">
                <div class="step-header">
                    <h5 class="step-title">Enter the OTP</h5>
                </div>
                <div class="step-body">
                    <form [formGroup]="otpForm" (ngSubmit)="validateOtp()">
                        <div class="form-group">
                            <label class="form-label">OTP</label>
                            <input class="form-control" formControlName="otp" placeholder="4-digit code" />
                        </div>
                        <div class="btn-group">
                            <button class="btn btn-secondary" type="button" (click)="step.set(1)"
                                [disabled]="busy()">Back</button>
                            <button class="btn btn-primary" type="submit" [disabled]="busy()">Verify OTP</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Step 3: New Password -->
            <div class="step-card" *ngIf="step() === 3">
                <div class="step-header">
                    <h5 class="step-title">Set a new password</h5>
                </div>
                <div class="step-body">
                    <form [formGroup]="newPwdForm" (ngSubmit)="doResetPassword()">
                        <div class="form-group">
                            <label class="form-label">New Password</label>
                            <input type="password" class="form-control" formControlName="newPassword" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">Confirm New Password</label>
                            <input type="password" class="form-control" formControlName="confirmNewPassword" />
                        </div>
                        <div class="btn-group">
                            <button class="btn btn-secondary" type="button" (click)="step.set(2)"
                                [disabled]="busy()">Back</button>
                            <button class="btn btn-primary" type="submit" [disabled]="busy()">Reset Password</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Always clickable navigation -->
        <a class="nav-link" routerLink="/login">‚Üê Back to Login</a>
    </div>

    <!-- Loading overlay -->
    <div *ngIf="busy()" class="loading-overlay">
        <div class="spinner"></div>
    </div>
</div>